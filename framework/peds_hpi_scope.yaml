meta:
  taxonomy_name: "Clinical HPI Taxonomy with Psychosocial & Context (D1–D9)"
  taxonomy_version: "1.0.0"
  profile: "peds"
  updated: "2025-08-07"
  scope_values: ["always", "conditional", "exclude"]
defaults:
  materiality_threshold_weight: 1
codes:
  # D1 — Chief Concern & Context
  - code: D1.CC-01
    scope: always
    when: "Include caregiver phrasing and child's phrasing when available."
  - code: D1.CC-02
    scope: always
  - code: D1.ONCTX-03
    scope: conditional
    when: "Triggers like daycare/school exposure, new foods, exertion."

  # D2 — Symptom Qualifiers (OLDCARTS+)
  - code: D2.ON-01
    scope: always
  - code: D2.LOC-02
    scope: always
  - code: D2.DUR-03
    scope: always
  - code: D2.CHAR-04
    scope: always
    when: "Use age-appropriate descriptors; proxy descriptors acceptable."
  - code: D2.AG-05
    scope: always
  - code: D2.AL-06
    scope: always
  - code: D2.RAD-07
    scope: always
  - code: D2.PAT-08
    scope: always
  - code: D2.SEV-09
    scope: always
    when: "Age-appropriate scales (e.g., FLACC); caregiver observations ok."
  - code: D2.NUM-10
    scope: conditional
    when: "Seizures/emesis/diarrhea/cough paroxysms, etc."

  # D3 — Associated & Pertinent Negatives
  - code: D3.POS-01
    scope: conditional
  - code: D3.PN-02
    scope: always
    when: "Key denials tied to pediatric differentials (e.g., retractions, apnea, dehydration signs)."
  - code: D3.CONST-03
    scope: conditional
    when: "Fever pattern, poor PO, weight change—often relevant."
  - code: D3.SYS-04
    scope: conditional
    when: "Cross-system ROS only if it changes triage/plan."

  # D4 — Temporal & Modifier Context
  - code: D4.TRAJ-01
    scope: always
  - code: D4.BASE-02
    scope: always
    when: "Feeding, stooling, urine output, development vs baseline when relevant."
  - code: D4.EXPO-03
    scope: always
    when: "Daycare/school sick contacts, travel, animals, water exposures."
  - code: D4.COMO-04
    scope: conditional
    when: "Chronic conditions (asthma, CHD, prematurity) that alter risk today."
  - code: D4.MED-05
    scope: always
    when: "Recent med changes, dosing, adherence; OTCs given by caregiver."
  - code: D4.PREG-06
    scope: conditional
    when: "Adolescents or pregnancy‑possible patients; lactation if applicable."
  - code: D4.IMMU-07
    scope: conditional
    when: "Immunosuppression/biologics/chemo; **not** routine immunization status."

  # D5 — Functional Impact
  - code: D5.ADL-01
    scope: conditional
    when: "Age-appropriate ADLs (feeding, mobility, play)."
  - code: D5.WORK-02
    scope: conditional
    when: "Repurpose for school/daycare attendance or activity restrictions."
  - code: D5.SLEEP-03
    scope: conditional
  - code: D5.QOL-04
    scope: conditional

  # D6 — Prior Interventions & Diagnostic History
  - code: D6.SELF-01
    scope: always
    when: "Home care given by caregiver (antipyretics, nasal suction, ORS)."
  - code: D6.DIAG-02
    scope: conditional
  - code: D6.PROC-03
    scope: conditional
  - code: D6.CONS-04
    scope: conditional
  - code: D6.FAM-05
    scope: conditional
    when: "Stronger emphasis in peds—FH that modifies risk (e.g., atopy, early cardiac death)."

  # D7 — Patient Goals & Perspective
  - code: D7.GOAL-01
    scope: conditional
    when: "Include caregiver’s goals/concerns; adolescent’s goals when relevant."
  - code: D7.FEAR-02
    scope: conditional
  - code: D7.PREF-03
    scope: conditional
  - code: D7.CULT-04
    scope: conditional

  # D8 — Risk & Safety-Net (generally not HPI)
  - code: D8.RF-01
    scope: exclude
  - code: D8.RP-02
    scope: exclude
  - code: D8.SN-03
    scope: exclude
  - code: D8.CAP-04
    scope: exclude

  # D9 — Psychosocial & Context
  - code: D9.TRAU-01
    scope: conditional
  - code: D9.STRESS-02
    scope: conditional
  - code: D9.CARE-03
    scope: conditional
    when: "Caregiver capacity/burden impacting history/access/monitoring."
  - code: D9.SUP-04
    scope: conditional
  - code: D9.LIVE-05
    scope: conditional
    when: "Household composition, crowding, housing stability when impacting illness."
  - code: D9.OCC-06
    scope: conditional
    when: "Repurpose for school/sports context (baseline)."
  - code: D9.ACT-07
    scope: conditional
  - code: D9.SUB-08
    scope: conditional
    when: "Adolescents: vaping, alcohol, substances if relevant to symptoms."
  - code: D9.SDOH-09
    scope: conditional
    when: "Medication/ORS affordability, childcare, equipment limits."
  - code: D9.TRAN-10
    scope: conditional
  - code: D9.INS-11
    scope: exclude
  - code: D9.PREF-12
    scope: conditional
  - code: D9.COORD-13
    scope: conditional
    when: "School nurse, therapists, specialists directly shaping today’s plan."
  - code: D9.LANG-14
    scope: conditional
    when: "Child/caregiver language or communication barriers affecting HPI accuracy."
  - code: D9.EDU-15
    scope: exclude
  - code: D9.SAF-16
    scope: conditional
    when: "Home safety concerns, supervision, IPV; escalate priority if present."
  - code: D9.LEG-17
    scope: conditional
    when: "Custody/guardianship affecting consent or history source."
  - code: D9.TECH-18
    scope: exclude
  - code: D9.ISO-19
    scope: conditional
  - code: D9.HLIT-20
    scope: conditional
    when: "Caregiver health literacy limiting accurate HPI or adherence."
